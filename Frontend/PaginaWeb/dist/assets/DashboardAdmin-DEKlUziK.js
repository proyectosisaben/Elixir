import{u as w,k as E,r as n,j as e,d as C,l as g,m as A,n as S,o as v,p as F,q as U,s as T,a as D,t as L,v as M}from"./index-COA3W7d3.js";function W(){const{usuario:o}=w(),l=E(),[a,b]=n.useState({totalUsuarios:0,totalClientes:0,totalVendedores:0,totalGerentes:0,totalAdmin:0,totalPedidos:0,ventasTotales:0}),[P,f]=n.useState([]),[N,c]=n.useState(!0),[h,x]=n.useState(null);n.useEffect(()=>{if(o&&o.rol!=="admin_sistema"){l("/dashboard-admin");return}d();const s=setInterval(d,3e4);return()=>clearInterval(s)},[o,l]);const d=async()=>{try{c(!0);const s=await fetch("http://localhost:8000/api/listar-clientes/"),r=s.ok?await s.json():null;let m=0,p=0;if(o!=null&&o.id)try{const i=await fetch(`http://localhost:8000/api/ventas-totales/?usuario_id=${o.id}`);if(i.ok){const t=await i.json();t.success&&t.ventas&&(m=t.ventas.total_ventas||0,p=t.ventas.total_pedidos||0)}}catch(i){console.log("Error cargando ventas totales:",i)}const u=await fetch("http://localhost:8000/api/productos/"),Y=u.ok?await u.json():null;if(r&&r.clientes){const i=r.clientes;f(i);const t={cliente:0,vendedor:0,gerente:0,admin_sistema:0};i.forEach(R=>{const j=R.rol||"cliente";t.hasOwnProperty(j)&&t[j]++}),b({totalUsuarios:i.length,totalClientes:t.cliente,totalVendedores:t.vendedor,totalGerentes:t.gerente,totalAdmin:t.admin_sistema,totalPedidos:p,ventasTotales:m})}x(null)}catch(s){console.error("Error cargando datos:",s),x("Error al cargar datos del sistema")}finally{c(!1)}},y=async()=>{if(window.confirm(`¿Estás seguro de que deseas hacer un backup de la base de datos?

Esto puede tomar algunos minutos.`))try{const s=await fetch("http://localhost:8000/api/backup-sistema/",{method:"POST",headers:{"Content-Type":"application/json"}}),r=await s.json();s.ok?alert(`✓ Backup realizado exitosamente

Archivo guardado en el servidor`):alert(`Error: ${r.message||"No se pudo completar el backup"}`)}catch(s){alert(`Error al hacer backup: ${s.message}`)}},k=()=>{const s=`
CONFIGURACIÓN DE SEGURIDAD DEL SISTEMA

Estado actual:
✓ Autenticación habilitada
✓ Conexión HTTPS (en producción)
✓ Validación de permisos activa
✓ Logs de sistema registrados

Opciones disponibles:
1. Ver logs de seguridad
2. Gestionar sesiones activas
3. Configurar 2FA
4. Auditoría de acceso

Selecciona una opción o cancela.
    `.trim(),r=prompt(s);r==="1"?alert("Función de logs disponible en próximas actualizaciones"):r==="2"?alert("Hay 1 sesión activa del administrador actual"):r==="3"?alert("2FA disponible en próximas actualizaciones"):r==="4"&&alert("Auditoría disponible en próximas actualizaciones")};return N?e.jsx("div",{className:"dashboard-admin-container",children:e.jsx("div",{className:"loading",children:e.jsx("p",{children:"Cargando panel de administración..."})})}):h?e.jsx("div",{className:"dashboard-admin-container",children:e.jsxs("div",{className:"alertas-section",children:[e.jsxs("h2",{children:[e.jsx(C,{})," Error"]}),e.jsx("p",{children:h}),e.jsx("button",{onClick:d,className:"btn btn-primary",children:"Reintentar"})]})}):e.jsxs("div",{className:"dashboard-admin-container",children:[e.jsx("div",{className:"gerente-header",children:e.jsx("div",{className:"gerente-header-content",children:e.jsxs("div",{className:"gerente-welcome",children:[e.jsx(g,{className:"header-icon"}),e.jsxs("div",{children:[e.jsx("h1",{children:"Panel de Administrador del Sistema"}),e.jsx("p",{children:"Control total del sistema, usuarios, ventas y base de datos"})]})]})})}),e.jsxs("div",{className:"gerente-main-container",children:[e.jsxs("div",{className:"metricas-grid",children:[e.jsxs("div",{className:"metrica-card ventas-totales",children:[e.jsxs("div",{className:"metrica-header",children:[e.jsx("h3",{children:"Usuarios Totales"}),e.jsx(A,{className:"metrica-icon"})]}),e.jsx("p",{className:"metrica-valor",children:a.totalUsuarios}),e.jsx("p",{className:"metrica-periodo",children:"Registrados en el sistema"}),e.jsx("div",{className:"metrica-bar",children:e.jsx("div",{className:"bar-fill",style:{width:"85%",transition:"width 0.8s ease"}})})]}),e.jsxs("div",{className:"metrica-card productos-total",children:[e.jsxs("div",{className:"metrica-header",children:[e.jsx("h3",{children:"Pedidos Totales"}),e.jsx(S,{className:"metrica-icon"})]}),e.jsx("p",{className:"metrica-valor",children:a.totalPedidos}),e.jsx("p",{className:"metrica-periodo",children:"Órdenes procesadas"}),e.jsx("div",{className:"metrica-bar",children:e.jsx("div",{className:"bar-fill",style:{width:"60%",transition:"width 0.8s ease"}})})]}),e.jsxs("div",{className:"metrica-card clientes",children:[e.jsxs("div",{className:"metrica-header",children:[e.jsx("h3",{children:"Ventas Totales"}),e.jsx(v,{className:"metrica-icon"})]}),e.jsxs("p",{className:"metrica-valor",children:["$",a.ventasTotales.toLocaleString("es-CL")]}),e.jsx("p",{className:"metrica-periodo",children:"Ingresos acumulados"}),e.jsx("div",{className:"metrica-bar",children:e.jsx("div",{className:"bar-fill",style:{width:"45%",transition:"width 0.8s ease"}})})]}),e.jsxs("div",{className:"metrica-card margen",children:[e.jsxs("div",{className:"metrica-header",children:[e.jsx("h3",{children:"Estado Sistema"}),e.jsx(F,{className:"metrica-icon"})]}),e.jsx("p",{className:"metrica-valor",children:"✓ Online"}),e.jsx("p",{className:"metrica-periodo",children:"Funcionando normalmente"}),e.jsx("div",{className:"metrica-bar",children:e.jsx("div",{className:"bar-fill",style:{width:"100%",transition:"width 0.8s ease"}})})]})]}),e.jsxs("div",{className:"productos-section",children:[e.jsxs("h2",{children:[e.jsx(g,{})," Distribución de Usuarios por Rol"]}),e.jsx("div",{className:"productos-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Rol"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Porcentaje"}),e.jsx("th",{children:"Estado"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Clientes"})}),e.jsx("td",{children:a.totalClientes}),e.jsxs("td",{children:[a.totalUsuarios>0?(a.totalClientes/a.totalUsuarios*100).toFixed(1):0,"%"]}),e.jsx("td",{children:e.jsx("span",{style:{background:"rgba(72, 187, 120, 0.1)",color:"var(--success-color)",padding:"4px 8px",borderRadius:"4px",fontWeight:"bold"},children:"Activo"})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Vendedores"})}),e.jsx("td",{children:a.totalVendedores}),e.jsxs("td",{children:[a.totalUsuarios>0?(a.totalVendedores/a.totalUsuarios*100).toFixed(1):0,"%"]}),e.jsx("td",{children:e.jsx("span",{style:{background:"rgba(72, 187, 120, 0.1)",color:"var(--success-color)",padding:"4px 8px",borderRadius:"4px",fontWeight:"bold"},children:"Activo"})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Gerentes"})}),e.jsx("td",{children:a.totalGerentes}),e.jsxs("td",{children:[a.totalUsuarios>0?(a.totalGerentes/a.totalUsuarios*100).toFixed(1):0,"%"]}),e.jsx("td",{children:e.jsx("span",{style:{background:"rgba(72, 187, 120, 0.1)",color:"var(--success-color)",padding:"4px 8px",borderRadius:"4px",fontWeight:"bold"},children:"Activo"})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Administradores"})}),e.jsx("td",{children:a.totalAdmin}),e.jsxs("td",{children:[a.totalUsuarios>0?(a.totalAdmin/a.totalUsuarios*100).toFixed(1):0,"%"]}),e.jsx("td",{children:e.jsx("span",{style:{background:"rgba(245, 101, 101, 0.1)",color:"var(--danger-color)",padding:"4px 8px",borderRadius:"4px",fontWeight:"bold"},children:"Crítico"})})]})]})]})})]}),e.jsxs("div",{className:"productos-section",children:[e.jsxs("h2",{children:[e.jsx(U,{})," Herramientas Administrativas"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px"},children:[e.jsxs("button",{onClick:()=>l("/admin/roles"),style:{padding:"20px",borderRadius:"10px",border:"none",background:"var(--primary-color)",color:"white",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:s=>s.target.style.transform="translateY(-3px)",onMouseLeave:s=>s.target.style.transform="translateY(0)",children:[e.jsx(T,{style:{marginRight:"10px"}}),"Gestionar Roles"]}),e.jsxs("button",{onClick:()=>l("/dashboard-vendedor"),style:{padding:"20px",borderRadius:"10px",border:"none",background:"#2ecc71",color:"white",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:s=>s.target.style.transform="translateY(-3px)",onMouseLeave:s=>s.target.style.transform="translateY(0)",children:[e.jsx(D,{style:{marginRight:"10px"}}),"Crear Bebida"]}),e.jsxs("button",{onClick:d,style:{padding:"20px",borderRadius:"10px",border:"none",background:"var(--success-color)",color:"white",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:s=>s.target.style.transform="translateY(-3px)",onMouseLeave:s=>s.target.style.transform="translateY(0)",children:[e.jsx(L,{style:{marginRight:"10px"}}),"Recargar Datos"]}),e.jsxs("button",{onClick:y,style:{padding:"20px",borderRadius:"10px",border:"none",background:"var(--warning-color)",color:"white",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:s=>s.target.style.transform="translateY(-3px)",onMouseLeave:s=>s.target.style.transform="translateY(0)",children:[e.jsx(v,{style:{marginRight:"10px"}}),"Backup Sistema"]}),e.jsxs("button",{onClick:k,style:{padding:"20px",borderRadius:"10px",border:"none",background:"var(--secondary-color)",color:"white",fontWeight:"bold",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:s=>s.target.style.transform="translateY(-3px)",onMouseLeave:s=>s.target.style.transform="translateY(0)",children:[e.jsx(M,{style:{marginRight:"10px"}}),"Seguridad"]})]})]})]})]})}export{W as default};
//# sourceMappingURL=DashboardAdmin-DEKlUziK.js.map
